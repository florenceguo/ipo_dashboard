# 📊 新股市场看板 - 数据更新指南

## 🔄 数据更新流程

### 1. 准备工作
确保您已经：
- ✅ 安装了Python和必要的库（pandas, openpyxl, windpy等）
- ✅ 有Wind数据库的访问权限
- ✅ `ipoinfo.py` 文件在当前目录

### 2. 更新数据步骤

#### 步骤1：修改数据范围
打开 `ipoinfo.py` 文件，找到以下部分并修改日期：

```python
# 在文件末尾的 if __name__ == "__main__": 部分
startdate = '20240101'  # 修改为您需要的开始日期
enddate = '20251231'    # 修改为您需要的结束日期
```

#### 步骤2：运行数据获取脚本
```bash
# 使用Anaconda Python运行
C:\ProgramData\anaconda3\python.exe ipoinfo.py
```

运行完成后，会生成类似 `新股周度统计YYYY-MM-DD.xlsx` 的Excel文件。

#### 步骤3：转换数据格式
```bash
# 运行数据转换脚本
C:\ProgramData\anaconda3\python.exe analyze_excel.py
```

这会自动：
- 🔍 找到最新的Excel文件
- 📊 读取所有工作表数据
- 🔄 转换为网站可用的JSON格式
- 💾 生成 `excel_data_summary.json` 文件

#### 步骤4：刷新网站
在网站上点击 "🔄 刷新数据" 按钮，或者直接刷新浏览器页面。

## 📁 文件结构

```
IPO数据相关/
├── ipoinfo.py                    # Wind数据获取脚本
├── analyze_excel.py              # 数据转换脚本
├── 新股周度统计YYYY-MM-DD.xlsx    # 生成的Excel文件
├── excel_data_summary.json       # 网站数据文件
├── index.html                    # 网站主页
├── app.js                        # 网站逻辑
├── server.py                     # 本地服务器
└── 数据更新指南.md               # 本文件
```

## 🚀 快速启动网站

```bash
# 启动本地服务器
C:\ProgramData\anaconda3\python.exe server.py
```

然后访问：
- 本地：http://localhost:8080
- 局域网：http://您的IP:8080 （朋友可访问）

## ❓ 常见问题

### Q1: 运行 ipoinfo.py 时出现 KeyError: 'issue_price'
**解决方案：** 确保Wind连接正常，在 `ipoinfo.py` 中设置 `reconnect = True`

### Q2: Excel文件是空的
**解决方案：** 
1. 检查Wind数据库连接
2. 确认日期范围内有数据
3. 检查网络连接

### Q3: 网站显示"数据加载失败"
**解决方案：**
1. 确保 `excel_data_summary.json` 文件存在
2. 运行 `analyze_excel.py` 重新生成JSON文件
3. 检查JSON文件格式是否正确

### Q4: 图表显示为0或异常
**解决方案：**
1. 检查Excel数据是否完整
2. 重新运行 `analyze_excel.py`
3. 检查浏览器控制台错误信息

## 📋 数据检查清单

更新数据后，请检查：
- [ ] Excel文件大小正常（不是几KB的空文件）
- [ ] JSON文件生成成功
- [ ] 网站能正常加载图表
- [ ] 统计数据显示正确
- [ ] 最新周期的数据已包含

## 🔧 自动化建议

您可以创建一个批处理文件来自动化整个流程：

```batch
@echo off
echo 正在更新新股数据...
C:\ProgramData\anaconda3\python.exe ipoinfo.py
echo 正在转换数据格式...
C:\ProgramData\anaconda3\python.exe analyze_excel.py
echo 数据更新完成！
pause
```

保存为 `更新数据.bat` 双击运行即可。

## 📞 技术支持

如果遇到问题，请检查：
1. 控制台错误信息
2. Excel文件内容
3. JSON文件格式
4. 网络和Wind连接状态

